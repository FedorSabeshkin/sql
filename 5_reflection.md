# Рефлексия по заданию

Неверно.  

а) Я не вводил единый критерий, а упорядочивал по каждому из 3 численных показателей.

б) неверно посчитанн опыт полученный в ходе битвы. Я считал общее кол-во НАВЫКОВ (skills), а нада ОПЫТ (experience).  
Непонятно было: опыт начинается с 0 на каждом level или нет? 

в) Добавляется временная таблица в которой выполняется SUM по CASE, который возвращает 1 или 0 для выжившего гнома. 
Сами данные для этой временной таблицы получаются путем JOIN по всем требуемых исходным таблицам и группировкой от экспедиции к территории, к статусу похода, к дате отправления и дате возвращения. 
Не очень понятно почему на втором месте в группировке стоит территория.

Группировка идет по столбцам основной таблицы экспедиции e.

г) Надо использовать NULLIF при делении, что бы не получить деление на 0.

д) Я Верно выполнил кастование типа при делении, что бы обработать нецелые результаты, но надо было так же выполнить умножение на 100 для результата. 

е) Число успешных встреч с существами можно было так же посчитать через SUM(CASE 
Мое выражение было не так плохо, но делил зачем-то на число неуспешных исходов, а не на общее.

ж) Главное тут, что в изначальном запросе сформулировано деление набора строк на набор строк, что неверно. 
Стоит сначала получить таблицу, пусть временную, в которой в каждой строке для экспедиции с ее id будет число успешных и общее число встреч.
Вторым запросом, я могу получить id экспедиции и уже результат деления с округлением, обработкой NPE и непосредственно делением числа успешных исходов на общее, которое будет корректно. Будут делиться числа, а не наборы строк.

з) В skills_progression  - НЕ учитываются новые skills полученные в ходе экспедиции. 
Конечно, если не предусмотренно что все возможные скилы уже занесены в БД предварительно с level 0.
В этом случае отработает верно.

Интересный прием с 2 JOIN одной и той же таблицы.  
Сначала присоединяем вроде как все записи
Потом все записи, но с учетом, что id оттуда = id из первого присоединения
Далее в WHERE, а не JOIN фильтруем результат по дате отправления больше даты начала похода и дате получения скила меньше даты завершения. 
Тут не учитываются краевые случаи получения опыта в первый и крайни день экспедиции.

и) EXTRACT позволяет из даты вычленить дни, месяцы, годы. Дни при этом начинаются с 1, что удобно для показачеловекочитаемого результата. 
Разность дат можно выполнить перед этим. Это будет корректно.
